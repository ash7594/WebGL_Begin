<html>
<head>
<!--info showcase 3D-->
</head>

<style>

*, body {
	margin: 0;
	padding: 0;
}

canvas {
	width: 50%;
	height: 50%;
	background: #000000;
}

</style>

<body>

<script src="../js/three.js"></script>
<script>

var scene,camera,renderer;
var planes = [];
var circles = [];
var keys = [];

/////////////////////////////////

var canvas = document.createElement('canvas');
var ctx = canvas.getContext('2d');
canvas.width = canvas.height = 100;

/////////////////////////////////

document.addEventListener("keydown",function(e) {keys[e.keyCode]=true});
document.addEventListener("keyup",function(e) {keys[e.keyCode]=false});

function init() {
	scene = new THREE.Scene();
	camera = new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,2100);
	scene.add(camera);
	//camera.position.y = -450;
    camera.position.z = 1000;
    //camera.rotation.x = 90 * (Math.PI / 180);
	
	renderer = new THREE.WebGLRenderer({alpha:true});
	renderer.setSize(window.innerWidth,window.innerHeight);
	renderer.setClearColor(0x000000,1);
	document.body.appendChild(renderer.domElement);
}

function createPlanesAndCircles() {
	for(var k=0;k<=10;k++) {
		for(var i=-5;i<=5;i++) {
			for(var j=-5;j<=5;j++) {
				plane(i*300,j*300,k*200);
				circle(i*300,(j*300)+50,k*200);
				//plane(i*300,j*300,k*200);
			}
		}
	}
}

function plane(x,y,z) {

	ctx.fillStyle = "#ff0000";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle = "#0000ff";
    ctx.font = 20+"px serif";
    ctx.fillText("\"Works at Delta\"",5,60);
    var texture = new THREE.Texture(canvas);
    texture.needsUpdate = true;

	var materials = [new THREE.MeshBasicMaterial({color:0xff0000,transparent:true,opacity:0.4,side:THREE.BackSide}),new THREE.MeshBasicMaterial({map:texture,side:THREE.FrontSide})];

	var geometry = new THREE.PlaneGeometry(100,100);
	for(var i=0, len=geometry.faces.length; i<len; i++) {
    	var face = geometry.faces[i].clone();
    	face.materialIndex = 1;
    	geometry.faces.push(face);
    	geometry.faceVertexUvs[0].push(geometry.faceVertexUvs[0][i].slice(0));
	}

	var plane = new THREE.Mesh(geometry, new THREE.MeshFaceMaterial(materials));

	plane.position.x += x;
	plane.position.y += y;
	plane.rotation.y += Math.PI;
	plane.position.z -= z;

	plane.material.side = THREE.DoubleSide;	
	plane.overdraw = true;
	scene.add(plane);
	planes.push(plane);
}

function circle(x,y,z) {
	var geometry = new THREE.CircleGeometry(25,8);
	THREE.ImageUtils.crossOrigin = '';
	var texture = THREE.ImageUtils.loadTexture('https://fbcdn-profile-a.akamaihd.net/hprofile-ak-xap1/v/t1.0-1/c0.0.56.56/p56x56/10985242_934227183268201_1068029399536486042_n.jpg?oh=b24342e607421a5d3ccac916963ded39&oe=5593899F&__gda__=1434868643_22cd3a255b73c444d04123cfdd9229f7');
	var material = new THREE.MeshBasicMaterial({map:texture,transparent:true,opacity:0.4});
	var circle = new THREE.Mesh(geometry,material);
	circle.position.x += x;
	circle.position.y += y;
	circle.position.z -= z-1;

	circle.overdraw = true;
	scene.add(circle);
	circles.push(circle);
}

function interactCam() {
	if(keys[37]) {
		camera.position.x -= 10;
	}
	if(keys[38]) {
        camera.position.z -= 10;
    }
	if(keys[39]) {
        camera.position.x += 10;
    }
	if(keys[40]) {
        camera.position.z += 10;
    }
}

function render() {
	requestAnimationFrame(render);
	//plane.rotation.z += 0.01;
	interactCam();
	planes[60].rotation.y += 0.1;
	renderer.render(scene,camera);
}



init();
createPlanesAndCircles();
render();

</script>
</body>
</html>
